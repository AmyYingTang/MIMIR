# MIMIR 核心原则

> **版本**: v1.1  
> **创建日期**: 2025-01-31  
> **最后更新**: 2025-02-01  
> **来源**: Task Decomposition 实践验证 + Agent 自动化实验

---

## 概述

本文档记录 MIMIR 方法论的核心设计原则。这些原则适用于所有 Skill，指导 AI-人类协作的方式。

---

## 原则 1：用户输入最小化 (Minimum User Input)

### 定义

在设计 AI 主导的任务流程时，最大化 AI 的自主性，最小化用户的操作负担。

### 核心要点

1. **只问必要的问题**
   - 只询问 AI 无法自动获取的信息
   - 一次性收集所有必要输入，避免反复打断用户

2. **用户回答一次，AI 完成后续**
   - 获得必要信息后，AI 自主完成所有后续步骤
   - 包括：执行、验证、错误处理

3. **AI 负责汇报而非询问**
   - 执行过程中遇到问题，AI 先尝试解决
   - 解决不了再汇报，并附带可能的解决方案

4. **"懒用户"是正确的假设**
   - 系统适应用户，而非用户适应系统
   - 用户应该能以最少的精力获得最好的结果

### 反模式

| 反模式 | 问题 | 正确做法 |
|--------|------|----------|
| 逐步询问 | 打断用户思路 | 一次性收集所有必要信息 |
| 列出步骤让用户执行 | 增加用户负担 | AI 自主执行并汇报结果 |
| 假设用户懂技术细节 | 不友好 | 隐藏技术细节，只暴露业务决策 |
| 出错时只报告错误 | 无建设性 | 报告错误 + 提供解决方案 |

### 应用场景

- 编写 Claude Code prompts
- 设计任何人机协作流程
- Task Decomposition 中划分人/AI 职责边界
- 所有需要人机交互的 Skill 设计

### 来源

此原则来自 2025-01-31 的 Task Decomposition 验证实践。在设计用户认证模块的 Claude Code prompts 时，最初的设计假设用户会手动执行技术步骤。经过 review，改为 AI 主导执行、用户只提供必要输入的模式，效果显著提升。

---

## 原则 2：可验证的每一步 (Verifiable Steps)

### 定义

任务分解后的每一步都必须有明确的验收标准，可以被客观验证。

### 核心要点

1. **明确的完成标志**
   - 每个步骤结束时，有可验证的产出物
   - 例如：文件已创建、测试通过、服务可访问

2. **自动化验证优先**
   - 尽量通过代码/脚本验证，而非人工检查
   - 例如：运行测试、检查文件存在、curl 接口

3. **失败时可定位**
   - 验证失败时，能明确指出是哪一步出了问题
   - 便于排查和修复

### 来源

此原则来自 Task Decomposition 验证实践中每个 Prompt 的验收标准设计。

---

## 原则 3：渐进式构建 (Incremental Building)

### 定义

复杂系统应该从最小可运行版本开始，逐步添加功能。

### 核心要点

1. **先骨架后血肉**
   - 先搭建可运行的最小结构
   - 再逐步填充业务逻辑

2. **每一步都可运行**
   - 不是做完全部才能跑
   - 而是每增加一部分，系统仍然可运行

3. **持续验证**
   - 每增加一部分就验证一次
   - 及早发现问题

### 来源

此原则来自 Task Decomposition 验证实践中 6 个 Prompts 的设计：从项目初始化（骨架）到最后的初始化脚本（完整功能），每一步都保持系统可运行。

---

## 版本历史

| 版本 | 日期 | 更新内容 |
|------|------|----------|
| v1.0 | 2025-01-31 | 初始版本，包含 3 个核心原则 |
| v1.1 | 2025-02-01 | 新增原则 4：输入验证前置（基于 Agent 自动化实验） |

---

## 原则 4：输入验证前置 (Validate Inputs Early)

### 定义

当用户提供外部系统连接信息（数据库、API、服务端点等）时，应在正式执行前立即验证，失败时允许修正，而非等到执行过程中才发现错误。

### 核心要点

1. **收集完即验证**
   - 不等到代码生成或部署阶段才发现连接失败
   - 收集完数据库密码后，立即测试连接

2. **区分输入类型**
   - **可预验证**：数据库连接、API 端点、文件路径——收集后立即测试
   - **不可预验证**：依赖于尚未生成的代码的配置——延迟验证

3. **失败时允许修正**
   - 验证失败不应终止整个流程
   - 让用户有机会重新输入，或选择跳过验证继续执行

4. **区分执行前确认与执行中确认**
   - 配置输入（如密码、端口）→ 执行前通过 Agent 收集并验证
   - 危险操作确认（如"是否执行迁移？"）→ 执行中通过交互模式处理

### 反模式

| 反模式 | 问题 | 正确做法 |
|--------|------|----------|
| 密码错误到迁移步骤才发现 | 浪费前面所有步骤的执行时间 | 收集完连接信息后立即测试 |
| 验证失败直接退出 | 可能只是打字错误 | 允许重新输入 |
| 所有输入都延迟验证 | 可预验证的不应等到执行时 | 可预验证的立即验证 |

### 来源

此原则来自 2025-02-01 的 Agent 自动化实验。用户输错了 MySQL 密码，Agent 将错误密码填充到所有 Prompt 模板中，直到第 6 步初始化脚本才发现连接失败，导致需要手动修复 `.env` 文件并重新执行。加入连接测试后，错误在输入阶段即可发现和修正。
