# 复盘记录：文档一致性管理

> **项目**: 语音模型个性化构建平台  
> **日期**: 2025-01-28  
> **类型**: 流程改进  
> **贡献者**: 项目团队

---

## 背景

在开发语音模型个性化构建平台的过程中，我们遇到了一个反复出现的问题：当一个文档变更时（如 UI 原型），相关文档（API 设计、状态机、业务规则）会因为忘记更新而变得不一致。

### 事件经过

1. UI 原型 v2.0 完成，新增了 Admin 任务队列管理功能
2. 完成后发现 API 设计没有包含所需的接口
3. 状态机没有包含 Admin 触发的状态转换
4. 业务规则没有文档化 Admin 操作权限
5. PRD 没有提及新功能

**根本原因**：我们依赖人类记忆来追踪文档依赖关系。随着项目变得更加复杂，这变得越来越不可靠。

---

## 我们学到了什么

### 1. 文档之间存在隐藏的依赖关系

不明显但关键的关系存在：

| 当这个变更时... | ...检查这些 |
|----------------|------------|
| UI 原型 | API 设计、状态机、业务规则、PRD |
| PRD | 所有技术文档 |
| API 设计 | 数据库、业务规则、状态机 |
| 状态机 | API 设计、业务规则 |

### 2. 人类记忆是不够的

- 容易忘记哪些文档受影响
- 不同团队成员有不同的认知
- 在时间压力下，步骤会被跳过
- 没有审计追踪检查了什么

### 3. 流程需要自动化支持

- 检查清单减少认知负担
- 依赖关系图使关系显式化
- 模板确保一致性
- 记录使学习和改进成为可能

---

## 实施的解决方案

### 1. 文档依赖关系图 (`doc-dependencies.yaml`)

创建文档关系的结构化定义：

```yaml
documents:
  ui_prototype:
    triggers_review:
      - api-design.md
      - state-machines.md
      - business-rules.md
      - prd.md
```

### 2. 变更检查清单模板

标准化的变更检查流程：
1. 识别变更了什么
2. 查阅依赖关系图
3. 检查每个受影响的文档
4. 记录已完成的更新
5. 更新项目控制文档

### 3. 融入工作流程

- 在任何重大文档变更后执行检查清单
- 纳入提交流程
- 定期审计漂移

---

## 效果

| 之前 | 之后 |
|------|------|
| UI 变更时忘记更新 API | 依赖关系图提醒我们 |
| 没有检查记录 | 检查清单提供审计追踪 |
| 文档版本不一致 | 原子更新保持版本对齐 |
| 知识在人的脑海中 | 知识被固化到流程中 |

---

## 对 MIMIR 的建议

### 添加到模板

1. **`doc-dependencies-template.md`** - 创建项目特定依赖关系图的模板
2. **`change-review-checklist-template.md`** - 文档变更检查的清单

### 添加到企业级 Web SKILL

新阶段：**Phase 8: 文档一致性管理**
- 解释问题
- 提供解决方案
- 定义工作流程
- 列出产出物

### 更新 SKILL-INDEX

- 在结构图中添加新模板
- 更新版本历史

---

## 关键收获

1. **让隐性知识显性化** - 文档依赖关系应该被写下来，而不是被记住
2. **流程优于英雄主义** - 好的流程胜过依赖个人记住所有事情
3. **检查清单有效** - 简单的工具可以预防复杂的问题
4. **持续改进** - 每个项目都可以改进方法论

---

## 版本历史

| 版本 | 日期 | 更新内容 |
|------|------|----------|
| v1.0 | 2025-01-28 | 初始复盘记录 |
