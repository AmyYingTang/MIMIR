# Phase 1: 需求分析阶段

> **阶段目标**: 明确项目要做什么、为谁做、做到什么程度  
> **产出物**: PRD 文档、优先级定义、MVP 范围  
> **关键原则**: 问对问题比给出答案更重要

---

## 1. Agent 提问清单

### 1.1 业务理解

```markdown
让我先了解业务背景：

**核心问题**
1. 这个系统要解决什么业务问题？（痛点是什么？）
2. 目前这个问题是怎么解决的？（现状是什么？）
3. 为什么需要做一个新系统？（做的动机？）

**用户与价值**
4. 目标用户是谁？（具体描述用户画像）
5. 用户通过这个系统能完成什么任务？
6. 成功的标准是什么？（可衡量的指标）

**业务流程**
7. 核心业务流程是什么？（用户从开始到完成的步骤）
8. 有哪些角色参与？各自负责什么？
9. 有没有需要人工审批/介入的环节？
```

### 1.2 规模与性能

```markdown
了解一下规模预期：

**用户规模**
1. 预计有多少用户会使用这个系统？
   - [ ] < 50 人（小团队）
   - [ ] 50-500 人（中型组织）
   - [ ] 500-5000 人（大型组织）
   - [ ] > 5000 人（大规模）

2. 同时在线的用户大概有多少？（并发）

3. 用户增长预期？（未来 1-2 年）

**数据规模**
4. 预计会产生多少数据？
   - 每天新增多少条记录？
   - 核心数据表预计多大？

**性能要求**
5. 对响应速度有特殊要求吗？
6. 有没有需要实时处理的场景？
```

### 1.3 用户与权限

```markdown
关于用户和权限：

**用户类型**
1. 有几种类型的用户？请列举
2. 每种用户的主要职责是什么？
3. 用户之间有没有上下级/归属关系？

**权限需求**
4. 不同用户能看到的数据一样吗？（数据隔离）
5. 不同用户能执行的操作一样吗？（功能权限）
6. 权限是按角色分配还是按个人分配？

**认证需求**
7. 用户怎么登录？（用户名密码 / 手机号 / 邮箱）
8. 需要支持第三方登录吗？（微信/钉钉/企业 SSO）
9. 对密码强度有要求吗？
```

### 1.4 集成与扩展

```markdown
关于与其他系统的集成：

**现有系统**
1. 需要和哪些现有系统对接？
2. 对接方式是什么？（API / 数据库 / 文件）
3. 数据需要双向同步还是单向？

**未来扩展**
4. 未来可能需要对接哪些系统？（提前预留接口）
5. 未来可能需要开放 API 给第三方吗？
6. 是否考虑移动端 App？

**数据迁移**
7. 有没有历史数据需要迁移？
8. 数据格式是什么？质量如何？
```

### 1.5 技术约束

```markdown
了解一下技术环境和约束：

**现有技术栈**
1. 公司/团队主要用什么技术栈？
2. 有没有必须使用的技术？
3. 有没有禁止使用的技术？

**基础设施**
4. 系统部署在哪里？（公有云 / 私有云 / 本地服务器）
5. 有没有现成的数据库可以用？
6. 有没有 CI/CD 流程？

**合规要求**
7. 有没有数据存储位置的要求？（必须在境内等）
8. 有没有安全认证要求？（等保、ISO 等）
9. 有没有审计要求？（操作日志、访问记录等）

**资源约束**
10. 项目预算范围？
11. 开发周期预期？
12. 开发团队配置？
```

---

## 2. 信息整理与确认

收集完信息后，按以下格式整理并与用户确认：

```markdown
## 项目概况确认

### 项目基本信息
- **项目名称**: [名称]
- **项目类型**: 企业级 Web 应用
- **核心价值**: [一句话描述]

### 用户与规模
- **目标用户**: [用户类型列表]
- **用户量级**: [预估数量]
- **并发预估**: [预估数量]

### 用户角色
| 角色 | 说明 | 主要功能 |
|------|------|----------|
| [角色1] | [描述] | [功能列表] |
| [角色2] | [描述] | [功能列表] |

### 核心功能
1. [功能1] - [简述]
2. [功能2] - [简述]
3. [功能3] - [简述]

### 技术约束
- **部署环境**: [描述]
- **技术偏好**: [描述]
- **合规要求**: [描述]

### 时间与资源
- **期望周期**: [时间]
- **团队规模**: [人数]

---
以上理解是否正确？有需要补充或修正的吗？
```

---

## 3. 功能优先级划分

### 优先级定义

| 优先级 | 定义 | 标准 |
|:------:|------|------|
| **P0** | 核心功能 | MVP 必须有，没有就不能用 |
| **P1** | 必要功能 | 上线时必须有，否则影响使用 |
| **P2** | 增强功能 | 有了更好，可以后续迭代 |
| **P3** | 未来功能 | 远期考虑，架构预留即可 |

### 划分原则

1. **从用户价值出发**: 这个功能不做，用户能完成核心任务吗？
2. **考虑依赖关系**: 被其他功能依赖的功能优先级更高
3. **评估实现成本**: 低成本高价值的功能优先
4. **预留扩展空间**: P3 功能在架构上预留接口

### Agent 引导话术

```markdown
现在让我们来划分功能优先级。我会列出所有功能，你帮我确认：

**P0 - 核心功能（MVP 必须）**
这些功能如果没有，系统就无法使用：
- [ ] [功能1]
- [ ] [功能2]

**P1 - 必要功能（上线必须）**
这些功能上线时需要有，否则影响正常使用：
- [ ] [功能3]
- [ ] [功能4]

**P2 - 增强功能（可后续迭代）**
有了更好，但可以先不做：
- [ ] [功能5]
- [ ] [功能6]

**P3 - 未来功能（架构预留）**
远期可能需要，现在只需要在设计上预留：
- [ ] [功能7]
- [ ] [功能8]

这个优先级划分合理吗？
```

---

## 4. MVP 范围定义

### MVP 原则

| 原则 | 说明 |
|------|------|
| **最小** | 只包含验证核心价值的最少功能 |
| **可行** | 必须能跑通完整流程 |
| **可测** | 能够收集用户反馈 |

### MVP 检查清单

- [ ] 包含所有 P0 功能
- [ ] 核心业务流程能完整跑通
- [ ] 基础的用户认证
- [ ] 基础的权限控制
- [ ] 基础的错误处理
- [ ] 不包含任何 P2/P3 功能的实现（可预留接口）

---

## 5. PRD 文档结构

最终产出的 PRD 应包含：

```markdown
# [项目名称] - 产品需求文档 (PRD)

## 1. 项目概述
### 1.1 项目背景
### 1.2 项目目标
### 1.3 术语定义

## 2. 用户分析
### 2.1 目标用户
### 2.2 用户角色与权限
### 2.3 用户旅程

## 3. 功能需求
### 3.1 功能模块总览
### 3.2 模块详细需求
（每个模块包含：功能描述、用户故事、验收标准）

## 4. 非功能需求
### 4.1 性能需求
### 4.2 安全需求
### 4.3 可用性需求
### 4.4 兼容性需求

## 5. 系统约束
### 5.1 技术约束
### 5.2 业务约束
### 5.3 合规约束

## 6. 优先级与里程碑
### 6.1 优先级划分
### 6.2 MVP 范围
### 6.3 迭代计划

## 7. 附录
### 7.1 原型/线框图（如有）
### 7.2 业务流程图
### 7.3 待确认事项
```

---

## 6. 常见问题与陷阱

### 陷阱 1：需求镀金

**表现**: 用户或开发者不断添加"顺便做一下"的功能

**应对**: 
- 严格按优先级划分
- 每个新增功能都要问"这是 P 几？"
- MVP 范围确定后不再扩展

### 陷阱 2：伪需求

**表现**: "我觉得用户可能需要..."

**应对**:
- 追问"有没有具体的用户反馈？"
- 追问"如果没有这个功能，用户会怎样？"
- 不确定的放到 P2/P3

### 陷阱 3：过度设计预留

**表现**: "虽然现在不需要，但以后可能需要，我们先实现一下"

**应对**:
- 区分"架构预留"和"功能实现"
- 架构上留接口可以，但不要实现
- YAGNI 原则：You Ain't Gonna Need It

### 陷阱 4：忽视非功能需求

**表现**: 只关注功能，忽视性能、安全、可维护性

**应对**:
- 强制包含非功能需求章节
- 用检查清单确保不遗漏
- 在技术选型阶段验证可行性

---

## 版本历史

| 版本 | 日期 | 更新内容 |
|------|------|----------|
| v1.0 | 2025-01-27 | 初始版本 |
