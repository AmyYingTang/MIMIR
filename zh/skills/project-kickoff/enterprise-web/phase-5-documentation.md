# Phase 5: 文档交付

> **阶段目标**: 建立用户手册、管理员手册等交付文档  
> **核心产出**: User Guide, Admin Guide, 部署文档, API 文档

---

## 1. 文档类型与用途

| 文档类型 | 目标读者 | 内容 | 格式 |
|----------|----------|------|------|
| **用户手册** | 终端用户 | 功能使用说明 | Markdown → PDF |
| **管理员手册** | 系统管理员 | 后台管理操作 | Markdown → PDF |
| **部署文档** | 运维/DevOps | 安装配置步骤 | Markdown |
| **API 文档** | 开发者 | 接口说明 | Swagger 自动生成 |

---

## 2. 文档生成策略

### 2.1 核心原则

```
开发过程中                      上线时
    │                              │
    ▼                              ▼
维护 Markdown 文档  ────────────►  导出 PDF
    │                              (正式交付物)
    ▼                              
同时作为 AI 问答知识源
```

**好处**：
- 一份源文档，多种用途
- 开发中同步更新，不会遗漏
- AI 可以基于文档回答问题

### 2.2 静态 vs 动态

| 形式 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| **静态 PDF** | 正式、可离线、版本明确 | 更新不便 | 正式交付、合同要求 |
| **动态 AI 问答** | 灵活、可交互 | 需要基础设施 | 日常使用、快速查询 |
| **在线文档站** | 可持续更新 | 需要维护 | 开源项目、SaaS |

**推荐**：Markdown 维护 + PDF 交付 + AI 辅助查询

---

## 3. 文档结构模板

### 3.1 用户手册 (user-guide.md)

```markdown
# [产品名称] 用户手册

## 1. 快速入门
### 1.1 注册账号
### 1.2 首次登录
### 1.3 完成第一个任务

## 2. 功能说明
### 2.1 [功能A]
### 2.2 [功能B]
### 2.3 [功能C]

## 3. 常见问题
### 3.1 账号相关
### 3.2 功能相关
### 3.3 错误提示说明

## 附录
### A. 术语表
### B. 快捷键
```

### 3.2 管理员手册 (admin-guide.md)

```markdown
# [产品名称] 管理员手册

## 1. 管理员职责
### 1.1 用户管理
### 1.2 权限分配
### 1.3 系统配置

## 2. 操作指南
### 2.1 用户审核
### 2.2 权限配置
### 2.3 数据管理

## 3. 系统维护
### 3.1 日志查看
### 3.2 备份恢复
### 3.3 性能监控

## 4. 故障排查
### 4.1 常见问题
### 4.2 错误代码
```

### 3.3 部署文档 (deployment.md)

```markdown
# [产品名称] 部署文档

## 1. 环境要求
### 1.1 硬件要求
### 1.2 软件要求
### 1.3 网络要求

## 2. 安装步骤
### 2.1 准备工作
### 2.2 数据库安装
### 2.3 应用部署
### 2.4 配置说明

## 3. 验证测试
### 3.1 健康检查
### 3.2 功能验证

## 4. 运维操作
### 4.1 启动/停止
### 4.2 日志位置
### 4.3 备份策略
### 4.4 升级流程
```

---

## 4. 文档编写时机

### 4.1 与开发同步

| 开发阶段 | 文档更新 |
|----------|----------|
| 完成用户注册功能 | 更新 user-guide: 1.1 注册账号 |
| 完成管理员审核 | 更新 admin-guide: 2.1 用户审核 |
| 完成部署脚本 | 更新 deployment: 2.3 应用部署 |

### 4.2 检查清单

每完成一个功能后检查：
- [ ] 用户手册是否需要更新？
- [ ] 管理员手册是否需要更新？
- [ ] 是否有新的错误码需要记录？
- [ ] 是否有新的配置项需要说明？

---

## 5. 文档生成工具

### 5.1 Markdown → PDF

**推荐工具**：

| 工具 | 优点 | 适用场景 |
|------|------|----------|
| **Pandoc** | 命令行，可脚本化 | CI/CD 集成 |
| **Typora** | 所见即所得 | 手动导出 |
| **mdBook** | 生成文档站 | 在线文档 |

**Pandoc 命令示例**：

```bash
# 安装
sudo apt install pandoc texlive-xetex

# 导出 PDF（支持中文）
pandoc user-guide.md -o user-guide.pdf \
  --pdf-engine=xelatex \
  -V CJKmainfont="Noto Sans CJK SC" \
  -V geometry:margin=1in

# 批量导出
for f in docs/*.md; do
  pandoc "$f" -o "${f%.md}.pdf" --pdf-engine=xelatex
done
```

### 5.2 API 文档自动生成

**FastAPI**：自动生成 Swagger UI

```python
# 访问 /docs 即可看到 API 文档
# 或导出 OpenAPI JSON
# GET /openapi.json
```

---

## 6. 文档作为 AI 知识源

### 6.1 配置方式

1. 将 Markdown 文档放入 Claude Project
2. 创建知识索引文件（见下方模板）
3. 用户直接在 Project 中提问

### 6.2 知识索引模板

```markdown
# 项目知识索引

## 文档清单
| 文档 | 内容 | 典型问题 |
|------|------|----------|
| user-guide.md | 用户操作 | "怎么提交任务？" |
| admin-guide.md | 管理操作 | "怎么审核用户？" |
| deployment.md | 部署配置 | "环境要求是什么？" |

## 如何提问
直接问问题即可，例如：
- "注册流程是怎样的？"
- "管理员怎么配置用户权限？"
```

---

## 7. 文档维护原则

### 7.1 ✅ 推荐做法

| 做法 | 原因 |
|------|------|
| 开发完成后立即更新文档 | 不会遗忘细节 |
| 使用截图/示例 | 更直观 |
| 记录版本对应关系 | 便于追溯 |
| 让非开发人员 review | 确保可读性 |

### 7.2 ❌ 避免做法

| 做法 | 问题 |
|------|------|
| 上线前集中写文档 | 遗漏细节，压力大 |
| 只写给开发者看 | 用户看不懂 |
| 不更新旧内容 | 文档失真 |

---

## 8. 文档交付检查清单

上线前检查：

- [ ] 用户手册覆盖所有用户可见功能
- [ ] 管理员手册覆盖所有管理功能
- [ ] 部署文档可以从零开始部署
- [ ] 截图与实际界面一致
- [ ] 术语一致（与系统中显示的一致）
- [ ] PDF 导出无格式问题
- [ ] 版本号与软件版本一致

---

## 9. Agent 使用说明

当用户说"帮我写用户手册"或"建立文档体系"时：

1. **确认文档类型**：用户手册？管理员手册？部署文档？
2. **了解功能范围**：有哪些功能需要文档化
3. **使用模板**：按上述结构生成大纲
4. **AI 生成初稿**：根据 PRD、原型生成内容
5. **人类 review**：确保准确性和可读性

### 文档内容来源

| 来源 | 可提取内容 |
|------|------------|
| PRD | 功能说明、业务流程 |
| UI 原型 | 操作步骤、界面说明 |
| API 设计 | 错误码说明 |
| 业务规则 | 限制说明、校验规则 |

---

## 版本历史

| 版本 | 日期 | 更新内容 |
|------|------|----------|
| v1.0 | 2025-01-27 | 初始版本 |
